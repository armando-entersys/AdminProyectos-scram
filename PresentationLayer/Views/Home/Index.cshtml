@using System.IO
@{
    ViewData["Title"] = "Home Page";
}
<div>
    <script src="https://cdn.jsdelivr.net/npm/knockout@3.5.1/build/output/knockout-latest.min.js"></script>
</div>
<style>
    /* Dashboard Cards Mejoradas */
    .dashboard-card {
        border: none;
        border-radius: var(--border-radius-md);
        box-shadow: var(--shadow-md);
        transition: all var(--transition-normal);
        overflow: hidden;
        background: white;
    }

    .dashboard-card:hover {
        box-shadow: var(--shadow-lg);
        transform: translateY(-6px);
    }

    .dashboard-card .card-header {
        background: linear-gradient(135deg, var(--color-primary-main) 0%, var(--color-primary-light) 100%);
        color: white;
        padding: 1.25rem;
        border: none;
    }

    .dashboard-card .card-title {
        font-size: 1.15rem;
        font-weight: 600;
        margin: 0;
    }

    /* Stats Cards */
    .stat-box {
        background: white;
        border-radius: var(--border-radius-md);
        padding: 1.5rem 1rem;
        transition: all var(--transition-normal);
        box-shadow: var(--shadow-sm);
        border-top: 4px solid transparent;
        position: relative;
        overflow: hidden;
        cursor: pointer;
    }

    .stat-box::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--color-primary-main) 0%, var(--color-primary-lighter) 100%);
    }

    .stat-box:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-md);
    }

    .stat-box h2 {
        font-size: 2.5rem;
        font-weight: 700;
        margin: 0.5rem 0;
        background: linear-gradient(135deg, var(--color-primary-main) 0%, var(--color-primary-light) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .stat-box h6 {
        color: var(--color-secondary);
        font-weight: 600;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-top: 0.5rem;
    }

    /* Alertas Card */
    .alert-item {
        background: var(--color-neutral-50);
        border-radius: var(--border-radius-sm);
        padding: 1rem;
        margin-bottom: 0.75rem;
        border-left: 4px solid var(--color-primary-main);
        transition: all var(--transition-fast);
    }

    .alert-item:hover {
        background: white;
        box-shadow: var(--shadow-sm);
        transform: translateX(4px);
    }

    .alert-item .card-title {
        color: var(--color-primary-main);
        font-weight: 600;
        font-size: 1rem;
        margin-bottom: 0.5rem;
    }

    .alert-item .card-text {
        color: var(--color-secondary);
        font-size: 0.9rem;
    }

    /* Animación de carga */
    .dashboard-content {
        opacity: 0;
        transition: opacity 0.5s ease-in;
    }

    .dashboard-content.loaded {
        opacity: 1;
        animation: fadeIn 0.6s ease-in-out;
    }

    /* Iconos decorativos */
    .stat-icon {
        position: absolute;
        right: 1rem;
        top: 50%;
        transform: translateY(-50%);
        font-size: 3rem;
        opacity: 0.1;
        color: var(--color-primary-main);
    }
</style>

<div class="row gy-4 dashboard-content" id="dashboardContent">
    <!-- Alertas -->
    <div class="col-lg-6">
        <div class="card dashboard-card">
            <div class="card-header text-white">
                <h5 class="card-title mb-0">
                    <i class="lni lni-alarm me-2"></i>Alertas
                </h5>
            </div>
            <div class="card-body">
                <div data-bind="foreach: registrosAlerta">
                    <div class="alert-item">
                        <h5 class="card-title" data-bind="text: nombre"></h5>
                        <p class="card-text" data-bind="text: descripcion"></p>
                        <button class="btn btn-outline-primary btn-sm mt-2" data-bind="click: $root.Editar">
                            <i class="lni lni-eye me-1"></i>Ver Detalles
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Proyectos -->
    <div class="col-lg-6">
        <div class="card dashboard-card">
            <div class="card-header text-white">
                <h5 class="card-title mb-0">
                    <i class="lni lni-folder me-2"></i>Proyectos
                </h5>
            </div>
            <div class="card-body">
                <div class="row text-center g-3">
                    <div class="col-6 col-md-3">
                        <div class="stat-box" onclick="window.location.href='/Brief/IndexAdmin?filtroFecha=hoy'">
                            <h2 data-bind="text: Hoy"></h2>
                            <h6>Hoy</h6>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="stat-box" onclick="window.location.href='/Brief/IndexAdmin?filtroFecha=semana'">
                            <h2 data-bind="text: EstaSemana"></h2>
                            <h6>Esta Semana</h6>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="stat-box" onclick="window.location.href='/Brief/IndexAdmin?filtroFecha=proximaSemana'">
                            <h2 data-bind="text: ProximaSemana"></h2>
                            <h6>Próxima Semana</h6>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="stat-box" onclick="window.location.href='/Brief/IndexAdmin'">
                            <h2 data-bind="text: TotalProyectos"></h2>
                            <h6>Total</h6>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Materiales -->
    <div class="col-lg-6">
        <div class="card dashboard-card">
            <div class="card-header text-white">
                <h5 class="card-title mb-0">
                    <i class="lni lni-gallery me-2"></i>Materiales
                </h5>
            </div>
            <div class="card-body">
                <div class="row text-center g-3">
                    <div class="col-6 col-md-3">
                        <div class="stat-box" onclick="window.location.href='/Materiales?filtroFecha=hoy'">
                            <h2 data-bind="text: Hoy_Material"></h2>
                            <h6>Hoy</h6>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="stat-box" onclick="window.location.href='/Materiales?filtroFecha=semana'">
                            <h2 data-bind="text: EstaSemana_Material"></h2>
                            <h6>Esta Semana</h6>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="stat-box" onclick="window.location.href='/Materiales?filtroFecha=proximaSemana'">
                            <h2 data-bind="text: ProximaSemana_Material"></h2>
                            <h6>Próxima Semana</h6>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="stat-box" onclick="window.location.href='/Materiales'">
                            <h2 data-bind="text: TotalMaterial"></h2>
                            <h6>Total</h6>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Proyectos Finalizados -->
    <div class="col-lg-6">
        <div class="card dashboard-card">
            <div class="card-header text-white">
                <h5 class="card-title mb-0">
                    <i class="lni lni-checkmark-circle me-2"></i>Proyectos Finalizados
                </h5>
            </div>
            <div class="card-body">
                <div class="row text-center g-3 justify-content-center">
                    <div class="col-6">
                        <div class="stat-box" onclick="window.location.href='/Brief/IndexAdmin?filtroEstatus=finalizado&filtroTiempo=tiempo'">
                            <i class="lni lni-timer stat-icon"></i>
                            <h2 data-bind="text: ProyectoTiempo"></h2>
                            <h6>En Tiempo</h6>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="stat-box" onclick="window.location.href='/Brief/IndexAdmin?filtroEstatus=finalizado&filtroTiempo=extra'">
                            <i class="lni lni-alarm-clock stat-icon"></i>
                            <h2 data-bind="text: ProyectoExtra"></h2>
                            <h6>Extratemporal</h6>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        var RolId = @Html.Raw(ViewBag.RolId);
        var UsuarioId = @Html.Raw(ViewBag.UsuarioId);
    </script>
    <script src="~/js/Home/Home.js" asp-append-version="true"></script>
}
